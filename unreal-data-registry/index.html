<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unreal GameFeature + Data Registry 로 DLC 데이터 추가하기</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* 기본 스타일 */
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            color: #333;
            line-height: 1.6;
        }

        a {
            text-decoration: none;
            color: #4a90e2;
        }

        a:hover {
            text-decoration: underline;
        }

        /* 헤더 스타일 */
        header {
            background-color: #fff;
            padding: 20px 0;
            border-bottom: 1px solid #eee;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .header-container {
            max-width: 800px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .header-title {
            font-size: 28px;
            font-weight: 700;
            color: #333;
        }

        .header-nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
        }

        .header-nav li {
            margin-left: 25px;
        }

        .header-nav a {
            font-size: 16px;
            font-weight: 400;
            color: #555;
            transition: color 0.3s ease;
        }

        .header-nav a:hover {
            color: #000;
        }

        /* 메인 콘텐츠 스타일 (게시글 상세 페이지용) */
        main {
            max-width: 800px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .post-detail {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .post-detail .post-title {
            font-size: 32px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .post-detail .post-meta {
            font-size: 15px;
            color: #888;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }

        .post-detail .post-tags span {
            display: inline-block;
            background-color: #e0e0e0;
            color: #666;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 13px;
            margin-right: 8px;
            margin-top: 5px;
        }

        .post-detail .post-content {
            margin-top: 25px;
            font-size: 17px;
            color: #444;
        }

        /* 게시글 본문 내 스타일 */
        .post-content h2, .post-content h3, .post-content h4 {
            color: #333;
            margin-top: 35px;
            margin-bottom: 15px;
            font-weight: 700;
            line-height: 1.3;
        }
        .post-content h2 { font-size: 28px; }
        .post-content h3 { font-size: 24px; }
        .post-content h4 { font-size: 20px; }

        .post-content p {
            margin-bottom: 1em; /* 단락 간 간격 */
        }

        .post-content ul, .post-content ol {
            margin-left: 25px;
            margin-bottom: 1em;
        }
        .post-content li {
            margin-bottom: 0.5em;
        }
        
        /* 코드 블록 스타일 */
        .post-content pre {
            background-color: #282c34; /* Dark background for code */
            color: #abb2bf; /* Light text color */
            padding: 15px 20px;
            border-radius: 8px;
            overflow-x: auto; /* Horizontal scroll for long lines */
            margin: 25px 0;
            font-family: 'Roboto Mono', monospace; /* Monospace font for code */
            font-size: 15px;
            line-height: 1.4;
            white-space: pre-wrap; /* 자동 줄바꿈 */
        }

        .post-content code {
            font-family: 'Roboto Mono', monospace;
            font-size: 1em;
            background-color: #e0e0e0; 
            padding: 2px 5px;
            border-radius: 4px;
            color: #c7254e;
        }
        .post-content pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
            border-radius: 0;
        }

        /* 표 스타일 */
        .post-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
        }

        .post-content th, .post-content td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .post-content th {
            background-color: #f8f9fa;
            font-weight: 700;
        }

        .post-content tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        /* 푸터 스타일 */
        footer {
            text-align: center;
            padding: 30px 20px;
            margin-top: 50px;
            color: #777;
            font-size: 14px;
            border-top: 1px solid #eee;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-container">
            <div class="header-title">
                <a href="/">내 GitHub Pages</a>
            </div>
            <nav class="header-nav">
                <ul>
                    <li><a href="#">블로그</a></li>
                    <li><a href="#">태그</a></li>
                    <li><a href="#">소개</a></li>
                    <li><a href="https://github.com/TaehunKim0" target="_blank">GitHub</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <article class="post-detail">
            <h1 class="post-title">Unreal GameFeature + Data Registry 로 DLC 데이터 추가하기</h1>
            <div class="post-meta">
                <span class="post-date">2025년 10월 29일</span>
                <div class="post-tags">
                    <span>#UnrealEngine</span>
                    <span>#GameFeature</span>
                    <span>#DataRegistry</span>
                </div>
            </div>
            <div class="post-content">

                <h2>개요</h2>
                <hr>
                언리얼 엔진 5의 GameFeature Plugin 시스템을 활용하면, 게임의 핵심 로직을 건드리지 않고도 
새로운 컨텐츠를 런타임에 추가하거나 제거할 수 있다. 이 글에서는 Data Registry와 결합하여 
완전히 모듈화된 상점 및 DLC 시스템을 구축한 사례를 다룬다.

                <br>
                <h2>1. 요약</h2>
                <hr>
                <p>핵심은 <b>코어 게임 로직과 콘텐츠를 완전히 분리</b>하고, <b>Data Registry Source만으로 확장</b>하는 것.</p>
                <br>
                <p><b>1. ItemShop 게임 피처 플러그인 (상점 시스템)</b></p>
                <ul>
                    <li><code>Add Data Registry </code>: <code>DR_ShopItems</code> 레지스트리 생성 및 기본 아이템 데이터 등록</li>
                    <li><code>Add Widgets</code> : 상점 UI 활성화 (커스텀 GameFeatureAction)</li>
                    <li><b> 프로젝트 코어에서 상점 시스템을 제거하고 플러그인으로 관리 가능</b></li>
                </ul>

                <p><b>2. DLC_SpecialEdition 게임 피처 플러그인 (DLC 콘텐츠)</b></p>
                <ul>
                    <li><code>Add Data Registry Source</code> : 기존 <code>DR_ShopItems</code>에 DLC 아이템 데이터 소스 추가</li>
                    <li><b>추가 콘텐츠를 완전히 독립적으로 관리</b></li>
                </ul>

                <br>
                <image src="./images/상점DLC2.gif" width="750" height="400"></image>


                

                <br>
                <h2>2. 동작 흐름</h2>
                <hr>

                <h3>1. 기본 상점</h3>
                <hr>
                <image src="./images/ItemShop.png" width="750" height="400"></image>
                <p><b>1. ItemShop 게임 피처 플러그인 활성화</b></p>
                <ul>
                    <li>DR_ShopItems 레지스트리 추가 (DT_Default_Consumable 데이터 테이블이 등록돼있음)</li>
                    <li>Add Widgets 액션(커스텀 액션) 실행</li>
                </ul>

                <br>

                <p><b>2. 상점 UI 표시</b></p>
                <ul>
                    <li><code>UDataRegistrySubsystem</code> 을 이용해 ShopItems 레지스트리 모든 아이템 조회</li>
                    <li>조회된 아이템 데이터로 UI 초기화</li>
                    <li>기본 소비 아이템들이 상점에 표시됨</li>
                </ul>

                <br>
                <h3>2. DLC 추가</h3>
                <hr>
                <p><b>1. DLC_SpecialEdition 게임 피처 플러그인 활성화</b></p>
                <ul>
                    <li>기존 ShopItems Data Registry에 Data Registry Source로 DT_DLC_Consumable 추가</li>
                    <li>코어 시스템 수정 없이 순수하게 데이터만 추가</li>
                </ul>

                <br>
                <p><b>2. 자동으로 상점의 콘텐츠 확장</b></p>
                <ul>
                    <li>ShopItems 레지스트리가 자동으로 DLC 아이템 포함</li>
                    <li>상점 UI 오픈 시 기본 아이템 + DLC 아이템 모두 표시</li>
                    <li>런타임 소스 확인 시 데이터 테이블이 추가된 것을 확인 가능</li>
                    <image src="./images/RuntimeSource1.png" width="450" height="200"></image>
                    <image src="./images/RuntimeSource2.png" width="450" height="250"></image>
                </ul>
                  

                <br>
                <h2>3. 핵심 메커니즘</h2>
                <hr>

                <h3>0. Add Data Registry Source 는 대상 레지스트리에 Meta Source 가 필요</h3>
                <image src="./images/MetaSource.png" width="450" height="250"></image>

                <p><b>Meta Source 가 필요한 이유 (언리얼 공식 문서 참고)</b></p>
                <ul>
                    <li>런타임에 다른 데이터 소스를 생성하고 소유</li>
                    <li>모든 데이터 소스에 규칙을 적용하여 해당되는 에셋을 찾습니다</li>
                    <li>Meta Source가 발견한 데이터 소스는 런타임에 데이터 레지스트리에 로드됨</li>
                </ul>

                <p><b>먼저 데이터 레지스트리 소스를 등록하고 후에 레지스트리를 등록해도</b></p>
                <p><b>Meta Source 가 찾아서 로드할 수 있기 때문에 문제가 없다!</b></p>

                <p><b>DataTable 을 DataRegistry에 등록하기 위해 DataSource 로 생성해 런타임에 로드해줌</b></p>
                <p><b>런타임에 등록할 데이터 소스들을 관리해주는 역할!</b></p>

                <br>

                <h3>1. 게임 피처에 Data Registry 가 등록되는 타이밍은?</h3>
                <hr>
                <p>기본 GameFeatureAction_Add DataRegistry 은 Registered 단계에서 이미 게임에 등록된다.</p>
                <p>그래서 Activate 단계에서 데이터에 접근해도 문제가 생기지 않는다.</p>
                <code><pre>Installed ->Registered → Loaded → Activated
                            ↑
                Data Registry 등록 완료</pre></code>

                <br>
                <h3>1-1. DLC 게임 피처는 Installed 상태로 시작하는 것이 좋음.</h3>                
                <hr>
                <p>Registered 단계에서 데이터 레지스트리나 소스가 이미 엔진에 등록되어 검색과 데이터 접근이</p>
                <p>가능한 상태이기 때문에, 원치 않게 DLC 콘텐츠가 바로 노출될 수 있음.</p>

                <br>
                <h3>1-2. 게임 피처를 DeActivate 해도 데이터 레지스트리에 접근 가능한가?</h3>
                <hr>
                <p>Registered, Loaded 상태에서도 데이터 레지스트리가 검색과 접근이 가능하다고 했었다.</p>
                <p>그럼 게임 피처를 비활성화해도 똑같다면, 비활성화하는 의미가 없는 것 아닐까?</p>
                <p>아래 코드를 보자</p>
                
                <br>
                <p><b>메모리에는 남아 있지만, Deactivating 시점에 해당 레지스트리 경로를 검색하지 못하게 한다.</b></p>
                <!-- HTML generated using hilite.me --><div style="background: #1d2331; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%;"><span></span><span style="color: #73D0FF">void</span><span style="color: #D4D2C8"> </span><span style="color: #FFD173">UGameFeatureAction_DataRegistry::OnGameFeatureDeactivating</span><span style="color: #D4D2C8">(FGameFeatureDeactivatingContext</span><span style="color: #FFAD66">&amp;</span><span style="color: #D4D2C8"> Context)</span>
<span style="color: #D4D2C8">{</span>
<span style="color: #D4D2C8">    Super</span><span style="color: #FFAD66">::</span><span style="color: #D4D2C8">OnGameFeatureDeactivating(Context);</span>

<span style="color: #D4D2C8">    </span><span style="color: #FFAD66">if</span><span style="color: #D4D2C8"> (ShouldPreloadAtRegistration())</span>
<span style="color: #D4D2C8">    {</span>
<span style="color: #D4D2C8">       </span><span style="color: #7E8AA1">// This will only happen at unregistration</span>
<span style="color: #D4D2C8">       </span><span style="color: #FFAD66">return</span><span style="color: #D4D2C8">;</span>
<span style="color: #D4D2C8">    }</span>

<span style="color: #D4D2C8">    UDataRegistrySubsystem</span><span style="color: #FFAD66">*</span><span style="color: #D4D2C8"> DataRegistrySubsystem </span><span style="color: #FFAD66">=</span><span style="color: #D4D2C8"> UDataRegistrySubsystem</span><span style="color: #FFAD66">::</span><span style="color: #D4D2C8">Get();</span>
<span style="color: #D4D2C8">    </span><span style="color: #FFAD66">if</span><span style="color: #D4D2C8"> (ensure(DataRegistrySubsystem))</span>
<span style="color: #D4D2C8">    {</span>
<span style="color: #D4D2C8">       </span><span style="color: #FFAD66">for</span><span style="color: #D4D2C8"> (</span><span style="color: #FFAD66">const</span><span style="color: #D4D2C8"> TSoftObjectPtr</span><span style="color: #FFAD66">&lt;</span><span style="color: #D4D2C8">UDataRegistry</span><span style="color: #FFAD66">&gt;&amp;</span><span style="color: #D4D2C8"> RegistryToAdd </span><span style="color: #FFAD66">:</span><span style="color: #D4D2C8"> RegistriesToAdd)</span>
<span style="color: #D4D2C8">       {</span>
<span style="color: #D4D2C8">          </span><span style="color: #FFAD66">if</span><span style="color: #D4D2C8"> (</span><span style="color: #FFAD66">!</span><span style="color: #D4D2C8">RegistryToAdd.IsNull())</span>
<span style="color: #D4D2C8">          {</span>
<span style="color: #D4D2C8">             </span><span style="color: #7E8AA1">// This does not do any reference counting, warning above will hit if this is registered from two separate sources and then the first to deactivate will remove it</span>
<span style="color: #D4D2C8">             </span><span style="color: #FFAD66">const</span><span style="color: #D4D2C8"> FSoftObjectPath RegistryPath </span><span style="color: #FFAD66">=</span><span style="color: #D4D2C8"> RegistryToAdd.ToSoftObjectPath();</span>
<span style="color: #D4D2C8">             DataRegistrySubsystem</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">IgnoreRegistryPath(RegistryPath);</span>
<span style="color: #D4D2C8">          }</span>
<span style="color: #D4D2C8">       }</span>
<span style="color: #D4D2C8">    }</span>
<span style="color: #D4D2C8">}</span>
</pre></div>
                <br>
                <p><b>이렇게 Registered 단계에서도 메모리에는 남아있지만, 검색할 수 없다.</b></p>
                <image src="./images/DataTableLog.png" width="700" height="100"></image>

                <br>
                <br>

                <h3>2. Add Registry 가 Add RegistrySource 보다 먼저 OnDeactivating 되면?</h3>
                <hr>
                
                <p><b>Registry Deactivate 순서 문제와 그 결과</b></p>
                <code><pre>
                1. ItemShop Active
                2. DLC Active
                3. ItemShop Deactivate (먼저) ← 문제 시작
                4. DLC Deactivate (나중)</pre></code>
   
                <br>
                <p>ItemShop 게임 피처가 먼저 비활성화되면, Data Registry 가 검색되지 않도록 설정된다.</p>
                <p>그 후에 DLC 게임 피처가 비활성화되면, Data Registry Source 가 제거되려고 하지만 실패한다.</p>
                <ul>
                    <li>이미 DR_ItemRegistry 의 RuntimeSource 로 들어가 있었기 때문에</li>
                    <li>DR_ItemRegistry 가 검색이 불가능한 상태가 되면서, 문제가 생긴 것으로 보인다.</li>
                </ul>
                <!-- HTML generated using hilite.me --><div style="background: #1d2331; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%;"><span></span><span style="color: #D4D2C8">LogGameFeatures: OnGameFeatureDeactivating </span><span style="color: #FFAD66">/</span><span style="color: #D4D2C8">DLC_SpecialEdition</span><span style="color: #FFAD66">/</span><span style="color: #D4D2C8">DLC_SpecialEdition.DLC_SpecialEdition</span><span style="color: #FFAD66">:</span><span style="color: #D4D2C8">GameFeatureAction_DataRegistrySource_0</span><span style="color: #FFAD66">:</span><span style="color: #D4D2C8"> DataRegistry data table </span><span style="color: #FFAD66">/</span><span style="color: #D4D2C8">DLC_SpecialEdition</span><span style="color: #FFAD66">/</span><span style="color: #D4D2C8">Item</span><span style="color: #FFAD66">/</span><span style="color: #D4D2C8">DT_DLC_Comsumable.DT_DLC_Comsumable failed to unregister</span>
<span style="color: #D4D2C8">LogGameFeatures: Display</span><span style="color: #FFAD66">:</span><span style="color: #D4D2C8"> Game feature </span><span style="color: #F88F7F">&#39;</span><span style="color: #D4D2C8">DLC_SpecialEdition</span><span style="color: #F88F7F">&#39;</span><span style="color: #D4D2C8"> transitioned successfully. Ending state</span><span style="color: #FFAD66">:</span><span style="color: #D4D2C8"> Loaded [Loaded, Loaded]</span>
</pre></div>

                <br>
                <p>이유는 다음과 같다.</p>
                <hr>

                <br>
                <p><b>1. ItemShop Deactivate</b></p>
<!-- HTML generated using hilite.me --><div style="background: #1d2331; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%;"><span></span><span style="color: #D4D2C8">UGameFeatureAction_DataRegistry</span><span style="color: #FFAD66">::</span><span style="color: #D4D2C8">OnGameFeatureDeactivating()</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #D4D2C8">DataRegistrySubsystem</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">IgnoreRegistryPath(</span><span style="color: #D5FF80">&quot;/Game/ItemShop/DR_ShopItems&quot;</span><span style="color: #D4D2C8">)</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #D4D2C8">RefreshRegistryMap()</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #D4D2C8">RegistryMap.Remove(</span><span style="color: #D5FF80">&quot;ItemRegistry&quot;</span><span style="color: #D4D2C8">)  </span><span style="color: #7E8AA1">// DR_ShopItems 제거</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #D4D2C8">RegistryPathsToIgnore.Add(</span><span style="color: #D5FF80">&quot;/Game/ItemShop/DR_ShopItems&quot;</span><span style="color: #D4D2C8">)</span>
</pre></div>

                <p><b>결과: </b></p>
                <ul>
                    <li>DR_ShopItems 가 RegistryMap 에서 제거됨</li>
                    <li>하지만 객체는 메모리에 존재</li>
                    <li>접근만 차단된 상태 (Ignored)</li>
                </ul>
                <br>

                <p><b>2. DLC Deactivate 시도</b></p>
                <!-- HTML generated using hilite.me --><div style="background: #1d2331; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%;"><span></span><span style="color: #D4D2C8">UGameFeatureAction_DataRegistrySource</span><span style="color: #FFAD66">::</span><span style="color: #D4D2C8">OnGameFeatureDeactivating()</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #D4D2C8">DataRegistrySubsystem</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">UnregisterSpecificAsset(</span><span style="color: #D5FF80">&quot;ItemRegistry&quot;</span><span style="color: #D4D2C8">, </span><span style="color: #D5FF80">&quot;/DLC/.../DT_DLC_Consumable&quot;</span><span style="color: #D4D2C8">)</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #D4D2C8">UDataRegistry</span><span style="color: #FFAD66">*</span><span style="color: #D4D2C8"> FoundRegistry </span><span style="color: #FFAD66">=</span><span style="color: #D4D2C8"> GetRegistryForType(</span><span style="color: #D5FF80">&quot;ItemRegistry&quot;</span><span style="color: #D4D2C8">)</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #7E8AA1">// RegistryMap에 없음!</span>
<span style="color: #FFAD66">return</span><span style="color: #D4D2C8"> </span><span style="color: #FFAD66">nullptr</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #FFAD66">if</span><span style="color: #D4D2C8"> (FoundRegistry)  </span><span style="color: #7E8AA1">// false</span>
<span style="color: #D4D2C8">{</span>
<span style="color: #D4D2C8">    </span><span style="color: #7E8AA1">// 실행 안됨</span>
<span style="color: #D4D2C8">}</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #FFAD66">return</span><span style="color: #D4D2C8"> </span><span style="color: #FFD173">false</span><span style="color: #D4D2C8">  </span><span style="color: #7E8AA1">// 실패</span>
<span style="color: #D4D2C8">  </span><span style="color: #F88F7F">↓</span>
<span style="color: #D4D2C8">UE_LOG(LogGameFeatures, Log, TEXT(</span><span style="color: #D5FF80">&quot;failed to unregister&quot;</span><span style="color: #D4D2C8">))</span>
<span style="color: #F88F7F">```</span>
</pre></div>

                <p><b>결과: </b></p>
                <ul>
                    <li>UnregisterSpecificAsset 실패</li>
                    <li>로그 출력: "DT_DLC_Consumable failed to unregister"</li>
                </ul>

                <p>구체적인 코드는 해당 언리얼 소스파일을 확인하면 된다.</p>
                <br>

                <p>하지만, 추가한 데이터 레지스트리 소스도 DeInitialize 가 되므로, 플레이에서 문제는 발생하지 않는다.</p>
                <p>(단지 "사용 불가" 상태 마킹)</p>
                <!-- HTML generated using hilite.me --><div style="background: #1d2331; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%;"><span></span><span style="color: #73D0FF">void</span><span style="color: #D4D2C8"> </span><span style="color: #FFD173">UDataRegistrySource::Deinitialize</span><span style="color: #D4D2C8">()</span>
<span style="color: #D4D2C8">{</span>
<span style="color: #D4D2C8">    </span><span style="color: #FFAD66">if</span><span style="color: #D4D2C8"> (IsInitialized() </span><span style="color: #FFAD66">&amp;&amp;</span><span style="color: #D4D2C8"> GetRegistry())</span>
<span style="color: #D4D2C8">    {</span>
<span style="color: #D4D2C8">       bIsInitialized </span><span style="color: #FFAD66">=</span><span style="color: #D4D2C8"> </span><span style="color: #FFD173">false</span><span style="color: #D4D2C8">;</span>
<span style="color: #D4D2C8">    }</span>
<span style="color: #D4D2C8">}</span>
</pre></div>
                <br><br>

                <p><b>최종 결론: </b></p>
                <hr>
                <p>DLC 게임 피처가 Loaded 상태이기 때문에 DT_DLC_Consumable 은 메모리에 로드된 상태이며, </p>
                <p>UDataRegistrySubsystem 을 통한 접근은 차단 되었다. (DR_ShopItems 를 통해 접근하지 못하는 상태가 된다.)</p>
                <p>물론 DT_DLC_Consumable 은 직접 참조는 가능하다.</p>
                <p>(DataRegistrySource 로써 DeInitialize 된 것뿐이다) </p>
                <image src="./images/DataTableLog.png" width="700" height="100"></image>

                <br><br>

                <h3>3. 비동기 아이템 로딩</h3>
                <hr>
                <!-- HTML generated using hilite.me --><div style="background: #1d2331; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%;"><span></span><span style="color: #73D0FF">void</span><span style="color: #D4D2C8"> </span><span style="color: #FFD173">UBSItemShopSystem::LoadShopItems</span><span style="color: #D4D2C8">(FGameplayTagContainer FilterTags, </span>
<span style="color: #D4D2C8">    </span><span style="color: #FFAD66">const</span><span style="color: #D4D2C8"> FDataRegistryItemAcquiredCallback</span><span style="color: #FFAD66">&amp;</span><span style="color: #D4D2C8"> InCallback)</span>
<span style="color: #D4D2C8">{</span>
<span style="color: #D4D2C8">    </span><span style="color: #7E8AA1">// 모든 아이템 ID 가져오기</span>
<span style="color: #D4D2C8">    TArray</span><span style="color: #FFAD66">&lt;</span><span style="color: #D4D2C8">FDataRegistryId</span><span style="color: #FFAD66">&gt;</span><span style="color: #D4D2C8"> AllItemIds;</span>
<span style="color: #D4D2C8">    DRSubsystem</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">GetPossibleDataRegistryIdList(FName(</span><span style="color: #D5FF80">&quot;ShopItems&quot;</span><span style="color: #D4D2C8">), AllItemIds);</span>

<span style="color: #D4D2C8">    </span><span style="color: #7E8AA1">// 비동기로 각 아이템 로드</span>
<span style="color: #D4D2C8">    </span><span style="color: #FFAD66">for</span><span style="color: #D4D2C8"> (</span><span style="color: #FFAD66">const</span><span style="color: #D4D2C8"> FDataRegistryId</span><span style="color: #FFAD66">&amp;</span><span style="color: #D4D2C8"> ItemId </span><span style="color: #FFAD66">:</span><span style="color: #D4D2C8"> AllItemIds)</span>
<span style="color: #D4D2C8">    {</span>
<span style="color: #D4D2C8">        DRSubsystem</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">AcquireItem(ItemId, </span>
<span style="color: #D4D2C8">            FDataRegistryItemAcquiredCallback</span><span style="color: #FFAD66">::</span><span style="color: #D4D2C8">CreateLambda([...](...) {</span>
<span style="color: #D4D2C8">                </span><span style="color: #7E8AA1">// 필터링 및 캐싱</span>
<span style="color: #D4D2C8">                </span><span style="color: #FFAD66">if</span><span style="color: #D4D2C8"> (FilterTags.IsEmpty() </span><span style="color: #FFAD66">||</span><span style="color: #D4D2C8"> ItemData</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">ItemTag.HasAny(FilterTags))</span>
<span style="color: #D4D2C8">                {</span>
<span style="color: #D4D2C8">                    CachedItemIds.Add(AssetId);</span>
<span style="color: #D4D2C8">                }</span>
<span style="color: #D4D2C8">            })</span>
<span style="color: #D4D2C8">        );</span>
<span style="color: #D4D2C8">    }</span>
<span style="color: #D4D2C8">}</span>
</pre></div>

            <br>

            <h3>4. UI 갱신 흐름</h3>
            <hr>
            <!-- HTML generated using hilite.me --><div style="background: #1d2331; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%;"><span></span><span style="color: #7E8AA1">// 1. UI 생성 시 아이템 로드 요청</span>
<span style="color: #D4D2C8">ShopSubSystem</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">LoadShopItems(FilterTags, Callback);</span>

<span style="color: #7E8AA1">// 2. 모든 아이템 로드 완료 후 UI 구성</span>
<span style="color: #73D0FF">void</span><span style="color: #D4D2C8"> </span><span style="color: #FFD173">UBSShopWidget::OnShopItemsLoaded</span><span style="color: #D4D2C8">(</span><span style="color: #FFAD66">const</span><span style="color: #D4D2C8"> FDataRegistryAcquireResult</span><span style="color: #FFAD66">&amp;</span><span style="color: #D4D2C8"> Result)</span>
<span style="color: #D4D2C8">{</span>
<span style="color: #D4D2C8">    </span><span style="color: #FFAD66">for</span><span style="color: #D4D2C8"> (</span><span style="color: #FFAD66">const</span><span style="color: #D4D2C8"> </span><span style="color: #FFAD66">auto&amp;</span><span style="color: #D4D2C8"> ItemData </span><span style="color: #FFAD66">:</span><span style="color: #D4D2C8"> ShopSubSystem</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">GetAllItems())</span>
<span style="color: #D4D2C8">    {</span>
<span style="color: #D4D2C8">        </span><span style="color: #7E8AA1">// ShopItemWidget 생성 및 추가</span>
<span style="color: #D4D2C8">        ItemWidget</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">SetItemData(ItemData);</span>
<span style="color: #D4D2C8">        ItemListScrollBox</span><span style="color: #FFAD66">-&gt;</span><span style="color: #D4D2C8">AddChild(ItemWidget);</span>
<span style="color: #D4D2C8">    }</span>
<span style="color: #D4D2C8">}</span>
</pre></div>

            <br> <br>
            <h2>4. 장단점</h2>
            <hr>
            <h3>모듈형 게임 플레이로써의 장점</h3>
            <ul>
                <li>완전히 선택적으로 기능을 넣을 수 있다.</li>
                <li><b>독립적으로 기능들을 개발할 수 있다.</b></li>
                <li>게임은 피처에 의존하지 않아, 홀로 실행이 가능하다.</li>
            </ul>
            <!-- HTML generated using hilite.me --><div style="background: #1d2331; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%;"><span></span><span style="color: #D4D2C8">현재</span>
<span style="color: #D4D2C8">[Core Game] </span><span style="color: #FFAD66">-</span><span style="color: #D4D2C8"> 최소한의 기능만</span>
<span style="color: #D4D2C8">[ItemShop Plugin] </span><span style="color: #FFAD66">-</span><span style="color: #D4D2C8"> 상점 전체 시스템</span>
<span style="color: #D4D2C8">[DLC Plugin] </span><span style="color: #FFAD66">-</span><span style="color: #D4D2C8"> 현재는 데이터만 추가</span>
</pre></div>
            <br>

            <h3>협업에서의 장점</h3>
            <p>팀에서 개발하면서 팀원이 개발한 기능이 문제가 생겨 고쳐달라고 하는 요청하는 상황이 생기더라..</p>
            <p>이런 문제들을 정말 쉽게 해결할 수 있다.</p>
            <ul>
                <li>ItemShop 팀 완전 독립</li>
                <li>Core 팀은 ItemShop 모름</li>
                <li>ItemShop 없이도 게임 실행 됨.</li>
            </ul>

            <br>
            <h3>테스트에서의 장점</h3>
            <ul>
                <li>Feature별 테스트 가능</li>
                <li>특정 Feature만 활성화하여 디버깅</li>
                <li>QA 팀에서도 테스트가 용이</li>
            </ul>

            <br><br>
            <hr>
            <h3>단점</h3>
            <ul>
                <li>알아야 할 초기 학습 비용 크고, 구조 설계에 시간이 많이 든다…</li>
                <ul>
                    <li>게임 피처부터 시작해서, 피처 액션, 데이터 레지스트리, 소스, 데이터 에셋 등등</li>
                    <li>초기 학습 비용과 팀원들이 모두 활용할 수 있는 경우에는 정말 좋은 기능이라고 생각된다</li>
                    <li>버젼 관리에서도 문제를 일으킬 일이 크게 없을 가능성이 크다.</li>
                </ul>
                <li>생각보다 이쪽 관련 학습 문서가 없다</li>
                <ul>
                    <li>처음부터 Lyra 를 분석하는 것이 제일 도움이 된다.</li>
                    <li>Lyra 가 단순히 기능 시연용을 목적으로 만든게 아니고, 이렇게 해야 되는 구나라는게 분석하면서 느껴진다.</li>
                </ul>

                <li>데이터 레지스트리 비활성화 문제</li>
                <ul>
                    <li>위에서 설명했던 데이터 레지스트리 비활성화 순서 문제 같은 경우</li>
                    <li>언리얼에서 이 쪽 문제를 이미 테스트하고, 정리를 잘하는 같긴 하다.</li>
                </ul>
            </ul>

            <br> <br>
            <h2>5. 후기</h2>
            <hr>
            <p>처음에는 "DLC DataTable 1개 추가하는 건데 이렇게까지 해야 하나?" 싶었다. 
            GameFeature Plugin, Data Registry, Meta Source 는 뭐고 초기 설정도 복잡했다.</p>

            <p>하지만 막상 구축하고 나니, 재미있었고 되게 효과적이었다. 코드 한 줄 없이 데이터를 추가하고
                다시 빼는 것도 가능했다. </p>
            <p>중~대규모 팀에서 장기적인 프로젝트에 DLC 까지 계획중이라면 안 쓸 이유가 없는 구조인 것 같다
                초기 비용이 좀 들더라도 이전 프로젝트에서 활용했으면 좋았을텐데 하는 아쉬움이 남는다.</p>
            <p>그리고 데이터 레지스트리 관련 문제를 좀 디깅하면서 이 쪽 코드가 참 복잡했다. 타고 타고 타고 들어가는
                언리얼 디버깅...</p>
            </div>
        </article>
    </main>

    <footer>
        <p>&copy; 2025 [TaehunKim0]. All rights reserved.</p>
    </footer>
</body>
</html>